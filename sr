for d in */ ; do
    if [ -n "$2" ] && [[ ! $d =~ "$2" ]]; then
        continue
    fi
    if [ -n "$3" ] && [[ $d =~ "$3" ]]; then
        continue
    fi
    echo ""
    echo "-------------------"
    echo $d
    echo "-------------------"
    (cd $d && eval $1)
    echo "-------------------"
    echo ""
done